<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>ASV_analysis — asv_analysis • REvoBC</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="ASV_analysis — asv_analysis" />
<meta property="og:description" content="This function performs the analysis on ASV sequences identified by dada2.
First, it removes possible contamination sequences (ASVs resulting from other barcodes). 
Then it performs pairwise alignment using Needleman-Wunsch global alignment algorithm implemented in function pairwiseAlignment
in package Biostrings, aligning each sequence to the original barcode considered in the analysis 
(See the Biostrings documentation here for more details).
Then it considers all those sequences exhibiting a similarity higher than pid_cutoff_nmbc with the original barcode as Non-Marking Guide Controls.
Finally, it computes different statistics for the ASVS, storing:
 the relative frequency of all ASVs in each sample. 
 the relative frequency of each ASV in the samples.
 the counts for each ASV normalized to the counts of the sample with maximum frequency
 the frequency of the different ASVs in each sample." />






<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  

  

  </head>

  <body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">REvoBC</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.99.7</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/1_introduction.html">Introduction</a>
    </li>
    <li>
      <a href="../articles/2_running_REvoBC.html">Running REvoBC</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/Nowak-Lab/REvoBC/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>ASV_analysis</h1>
    <small class="dont-index">Source: <a href='https://github.com/Nowak-Lab/REvoBC/blob/master/R/user_functions.R'><code>R/user_functions.R</code></a></small>
    <div class="hidden name"><code>asv_analysis.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function performs the analysis on ASV sequences identified by dada2.
First, it removes possible contamination sequences (ASVs resulting from other barcodes). 
Then it performs pairwise alignment using Needleman-Wunsch global alignment algorithm implemented in function <code>pairwiseAlignment</code>
in package <code>Biostrings</code>, aligning each sequence to the original barcode considered in the analysis 
(See the Biostrings documentation <a href='https://www.rdocumentation.org/packages/Biostrings/versions/2.40.2/topics/pairwiseAlignment'>here</a> for more details).
Then it considers all those sequences exhibiting a similarity higher than <code>pid_cutoff_nmbc</code> with the original barcode as Non-Marking Guide Controls.
Finally, it computes different statistics for the ASVS, storing:
 the relative frequency of all ASVs in each sample. 
 the relative frequency of each ASV in the samples.
 the counts for each ASV normalized to the counts of the sample with maximum frequency
 the frequency of the different ASVs in each sample.</p>
    </div>

    <div class="ref-usage sourceCode"><pre class='sourceCode r'><code><span class='fu'>asv_analysis</span><span class='op'>(</span>
  <span class='va'>REvoBC_object</span>,
  barcode <span class='op'>=</span> <span class='st'>"BC10v0.ORG"</span>,
  output_figures <span class='op'>=</span> <span class='cn'>TRUE</span>,
  pid_cutoff_nmbc <span class='op'>=</span> <span class='fl'>98</span>,
  asv_count_cutoff <span class='op'>=</span> <span class='fl'>2</span>,
  <span class='va'>...</span>
<span class='op'>)</span></code></pre></div>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>REvoBC_object</th>
      <td><p>(Required). Object of class REvoBC, result of the function <code>initialize_REvoBC</code></p></td>
    </tr>
    <tr>
      <th>barcode</th>
      <td><p>(Required). String indicating the barcode used in the experiment.</p></td>
    </tr>
    <tr>
      <th>output_figures</th>
      <td><p>(Optional). Deafult TRUE: Boolean indicating whether a user whishes to store a figure indicating the number of ASV tracked during the different steps of the analysis.</p></td>
    </tr>
    <tr>
      <th>pid_cutoff_nmbc</th>
      <td><p>(Optional). Default to 98%. Percentage of similarity between a sequence and the original barcode. The ASVs with a similarity obve this threshold will be considered as original non-mutated sequences in the analysis.</p></td>
    </tr>
    <tr>
      <th>asv_count_cutoff</th>
      <td><p>(Optional). Default to 2. Minimum number of counts for an ASV to be considered in the statistics.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Any additional parameters passed to <code>pairwiseAlignment</code> from <code>Biostrings</code> (See description).</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The REvoBC object passed as a parameter with the following new fields:</p><ul>
<li><p><code>clean_asv_dataframe</code>: ASV sequences identified post-filtering (contamination removed,
sequences with a similarity higher than <code>pid_cutoff_nmbc</code> to the original barcode
aggregated to it and ASVs named in increasing order (ASV01, ASV02, etc.) according
to their total counts.</p></li>
<li><p><code>barcode</code>: Info about the barcode selected for the current analysis.</p></li>
<li><p><code>statistics</code>: another list with the following sub-fileds:</p><ul>
<li><p><code>asv_df_percentages</code>: dataframe with six columns. <code>asv_names</code> is the name of the ASV.
<code>day_organ</code> is the sample identifier (e.g. ID of an organ or, in case of longitudinal data, of the timepoint);
<code>count</code>: total counts for a specific ASV in a specific sample;
<code>perc_in_sample</code>: counts normalized to the total counts in the corresponding sample;
<code>perc_asv</code>: conuts normalized to the total counts for the corresponding ASV;
<code>perc_fold_to_max</code>: counts normalized to the maximum counts observed for the corresponding ASV in a sample.</p></li>
<li><p><code>asv_totalCounts</code>: for each ASV, total counts and number of samples in which it was detected.</p></li>
<li><p><code>sample_totalCounts</code>: for each sample, total counts and number of distinct ASVs detected.</p></li>
<li><p><code>asv_diversity_perSample</code>: measures of clonal richness and measures of heterogeneity computed for each sample based on the ASVs detected.</p></li>
<li><p><code>asv_persample_frequency</code>: counts for each ASV in each sample.</p></li>
<li><p><code>asv_persample_detection</code>: binary matrix indicating whether a sequence has been detected in the corresponding sample.</p></li>
<li><p><code>asv_toBarcode_similarity</code>: edit distance, percentage similarity and alignment score of each ASV compared to the original barcode.</p></li>
</ul></li>
</ul>  

<p>It saves the following <code>.csv</code> files in a sub-folder <code>asv_analysis</code> of the main output folder:</p><ul>
<li><p><code>sequences_barcode_mapping.csv</code>: dataframe that stores, for each sequence,
its counts in all samples. It also overwrites the sequence name (column seq_names) 
of those that exactly match any of the possible barcodes, using the barcode identifier. The sequences
that don't match the barcode in the current analysis may be due to contamination.</p></li>
<li><p><code>clean_asv_dataframe.csv</code>, <code>asv_totalCounts.csv</code>, <code>sample_totalCounts.csv</code>, <code>asv_df_percentages.csv</code>, <code>asv_diversity_perSample.csv</code>  
<code>asv_persample_frequency.csv</code>,</p></li>
<li><p><code>asv_persample_detection.csv</code>, <code>asv_diversity_perSample.csv</code> and <code>asv_toBarcode_similarity.csv</code>: content of the corresponding variables with the same name described above.</p></li>
</ul>


    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <div class="ref-examples sourceCode"><pre class='sourceCode r'><code><span class='r-in'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>revo_initialized</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>output_dir</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"extdata"</span>, <span class='st'>"output"</span>, package <span class='op'>=</span> <span class='st'>"REvoBC"</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>revo_initialized</span><span class='op'>$</span><span class='va'>output_directory</span> <span class='op'>=</span> <span class='va'>output_dir</span></span>
<span class='r-in'><span class='va'>revo_analyzed</span> <span class='op'>=</span> <span class='fu'>asv_analysis</span><span class='op'>(</span>REvoBC_object <span class='op'>=</span> <span class='va'>revo_initialized</span>, barcode <span class='op'>=</span> <span class='st'>'BC10v0.ORG'</span><span class='op'>)</span></span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span> <span class='warning'>Warning: </span>Removed 1 rows containing missing values (geom_vline).</span>
<span class='r-in'></span>
</code></pre></div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p><p>Developed by Lucrezia Patruno, Daniele Ramazzotti, Dawid Nowak.</p></p>
</div>

<div class="pkgdown">
  <p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.6.1.9001.</p></p>
</div>

      </footer>
   </div>

  


  

  </body>
</html>


